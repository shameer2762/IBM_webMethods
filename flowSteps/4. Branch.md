# 🧭 BRANCH Step in webMethods Designer

A **BRANCH** step in a flow service lets you execute different child paths depending on a pipeline variable’s value or on expressions. It’s similar to an *if-then/else* or *switch/case* logic block.

---

## 🎯 Purpose of BRANCH

- Directs execution from one of multiple possible child steps based on runtime data.
- Helps build conditional logic in your flow services, e.g., routing based on status codes, types, flags, etc.  
- Two main ways to branch:
  1. **Switch Value** – selecting a child step by matching a variable’s value.  
  2. **Expressions (Evaluate labels)** – each child step’s Label becomes a condition; the first child whose label expression evaluates to true is executed. 

---

## 🔧 Key Properties of the BRANCH Step

When you insert a BRANCH step, here are its main properties (with explanation):

| Property            | Description                                                                                     | Notes / Default                                   |
|---------------------|-------------------------------------------------------------------------------------------------|--------------------------------------------------|
| **Comments**         | Optional descriptive text you enter for this step.                                              | Default: *(blank)*                                |
| **Scope**            | The name of a document (IData object) in the pipeline to which this step is restricted. If you leave it blank, the step has access to the full pipeline.| Default: *(blank)* – full pipeline access        |
| **Timeout**          | Max number of seconds this step is allowed to execute. If this time elapses before the step completes, Integration Server issues a FlowTimeoutException and continues with the next step.| Default: *(blank)* – no explicit timeout         |
| **Label**            | Optional name for this BRANCH step (or for the purpose of other steps to target it). Required when used as target for an EXIT or another BRANCH. | Default: $(blank)$                                |
| **Switch**           | The name of the String (or constrained Object) variable whose value is used to determine which child step executes (for switch-mode).  | Default: *(blank)*                                |
| **Evaluate labels**  | Boolean flag: If **True**, the labels of child steps are treated as expressions; If **False** (default), the step uses the Switch property value to determine which label matches.  | Default: False                                    |

---

## 📘 Behavioural Details

### 1. **Switch Value Mode** (Evaluate labels = False)  
- You define a variable in **Switch** (e.g., `/order/status`).  
- Under the BRANCH, each child step (which must be indented / nested) has its **Label** property set to a literal value (e.g., `APPROVED`, `REJECTED`).  
- At runtime: the server reads the value of the switch variable; it matches a child whose label equals that value; that child step executes.  
- If the value is an empty string, leave Label blank in one child; if the value is null or unmatched, you can use label `$null` or `$default`. 

### 2. **Expression Mode** (Evaluate labels = True)  
- You leave **Switch** blank (do not specify).  
- For each child step, you set the **Label** property to an expression (e.g., `/order/amount > 1000`, or `/customer/type = "VIP"`).  
- At runtime: the server evaluates label expressions in order; the first expression that returns true results in that child step being executed.  
- If none of the expressions evaluate to true, include a child step with Label `$default` (to act as the “else” branch). 

---

## 🔍 Examples

**Example A – Switch value mode**  
```text
BRANCH step:
  Switch = /order/status

  Child step 1: Label = APPROVED → do approval logic
  Child step 2: Label = REJECTED → do rejection logic
  Child step 3: Label = $default  → do fallback logic
